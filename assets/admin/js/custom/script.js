function LoadAjaxScreen(controller,viewname) {
	// $(".se-pre-con").show();
	// 	$(".se-pre-con").fadeOut("slow");
	$.ajax({
	  type : 'POST',
	  url :baseurl+'admin/'+controller,
	  dataType : 'html',
	  data: {
	     viewname : viewname
	  },
	  success : function(data){

	  	if(data!==''){
	 		  $('#showloadscreen').html(data);

			 $( ".datepicker" ).datepicker({prevText : '<i class="fa fa-chevron-left"></i>',
				nextText : '<i class="fa fa-chevron-right"></i>'});
			  $('.phone').mask('0000-0000000');
			  $('.nic').mask('00000-0000000-0');
			 $('.js-example-basic-multiple').select2();
			 // $('.phone').mask('0000-0000');
				var responsiveHelper_dt_basic = undefined;
				var responsiveHelper_datatable_fixed_column = undefined;
				var responsiveHelper_datatable_col_reorder = undefined;
				var responsiveHelper_datatable_tabletools = undefined;

				var breakpointDefinition = {
					tablet : 1024,
					phone : 480
				};
						//Datatable
					$('#dt_basic').dataTable({
						"sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6'f><'col-sm-6 col-xs-12 hidden-xs'l>r>"+
							"t"+
							"<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-xs-12 col-sm-6'p>>",
						"autoWidth" : true,
				        "oLanguage": {
						    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>',
						      "oTableTools": {
		        	 "aButtons": [
		             "copy",
		             "csv",
		             "xls",
		                {
		                    "sExtends": "pdf",
		                    "sTitle": "SmartAdmin_PDF",
		                    "sPdfMessage": "SmartAdmin PDF Export",
		                    "sPdfSize": "letter"
		                },
		             	{
	                    	"sExtends": "print",
	                    	"sMessage": "Generated by SmartAdmin <i>(press Esc to close)</i>"
	                	}
		             ],
		            "sSwfPath": "js/plugin/datatables/swf/copy_csv_xls_pdf.swf"
		        },
						},
						"preDrawCallback" : function() {
							// Initialize the responsive datatables helper once.
							if (!responsiveHelper_dt_basic) {
								responsiveHelper_dt_basic = new ResponsiveDatatablesHelper($('#dt_basic'), breakpointDefinition);
							}
						},
						"rowCallback" : function(nRow) {
							responsiveHelper_dt_basic.createExpandIcon(nRow);
						},
						"drawCallback" : function(oSettings) {
							responsiveHelper_dt_basic.respond();
						}
					});


						//Datatable

						// Delete Alert
					$(".smart-mod-eg1").click(function(e) {

						var id=$(this).data("id");
						var action=$(this).data("action");
						var cname= $(this).data("cname");
						var vname= $(this).data("vname");

						$.SmartMessageBox({
							title : "Delete Record !",
							content : "Are you sure to delete this record ?",
							buttons : '[No][Yes]'
						}, function(ButtonPressed) {
							if (ButtonPressed === "Yes") {
									$.ajax({
										url:action,
										type:'POST',
										data:{id:id},
										success:function(result){
											if(result=='deleted'){
												$.smallBox({
													title : "Record Deleted",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully deleted</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
												LoadAjaxScreen(cname,vname);
											}
											else{
												$.smallBox({
													title : "Record Not Deleted",
													content : "<i class='fa fa-clock-o'></i> <i>Error found in the system </i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});
											}
										},
										error: function (xhr, textStatus, errorThrown){
											alert(xhr.responseText);
										}
									});

							}
							if (ButtonPressed === "No") {
								$.smallBox({
									title : "Request Cancelled",
									content : "<i class='fa fa-clock-o'></i> <i>Request successfully cancelled</i>",
									color : "#C46A69",
									iconSmall : "fa fa-times fa-2x fadeInRight animated",
									timeout : 4000
								});
							}

						});
						e.preventDefault();
					});
					// Delete Alert

					//SEarch form
					$("#search-form").submit(function(e){
						e.preventDefault();
						var action= $('#search-form').attr('action');
						var value =$("#search-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							success:function(result){

								if(result=="validationerrors"){
									$('#show_cust_table').css('display','none');
									$('#edit_cust_table').css('display','none');
									$('#add_cust_table').css('display','none');
									$.smallBox({
										title : "Validation Error",
										content : " <i>Field Required</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else if(result=='invalid'){

										$('#add_cust_table').css('display','block');
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Invalid Number",
										content : " <i>Record Not Exists Add New Customer</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									var data = $.parseJSON(result);
									$('#show_cust_table').css('display','block');
									$('#edit_cust_table').css('display','none');
									$('#add_cust_table').css('display','none');
									$('#resp_cust_vehicle_id').text(data.ID);
									$('#resp_cust_id').text(data.CUSTOMER_ID);
									$('#resp_chassis_no').text(data.CHASSIS_NO);
									$('#resp_engine_no').text(data.ENGINE_NO);
									$('#resp_regd_no').text(data.REGISTRATION_NO);
									$('#resp_colour').text(data.COLOR);
									$('#resp_cust_name').text(data.NAME);
									$('#resp_cust_address').text(data.ADDRESS);
									$('#resp_cust_contact').text(data.CONTACT);
									$('#resp_cust_nic').text(data.NIC);
									$('#resp_cust_city').text(data.CITY);
									$('#resp_model_colour').text(data.MODEL+' '+data.COLOR);
									$('#resp_cust_city_val').text(data.CITY_ID);
									$('#resp_cust_model_val').text(data.MODEL_ID);
									$('#resp_cust_color_val').text(data.COLOR_ID);
									$('#resp_cust_purch_dt').text(data.PURCHASE_DATE);
								}
							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//SEarch form



					$('#cancel_save_action').click(function(e){

						$( "#search-form" ).trigger( "submit" );
					});

					$('#cancel_add_save').click(function(e){

						LoadAjaxScreen('job_card','add_job_card');
					});


					$('#check_visit').click(function(e){
						var custvehid=$('#resp_cust_vehicle_id').text();
						$('#vehicle_id').val(custvehid);
								$.ajax({
							url:baseurl+'admin/job_card/check_visit',
							type:'POST',
							data: {custvehid:custvehid},
							success:function(result){
								$('#showvisitexist').html(result);

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});

					});
					$('#check_visit_update').click(function(e){
						var custvehid=$('#resp_cust_vehicle_id').text();
						var cusvisittype=$('#cusvisittype').val();
						$('#vehicle_id').val(custvehid);
								$.ajax({
							url:baseurl+'admin/job_card/check_visit_update',
							type:'POST',
							data: {custvehid:custvehid,cusvisittype:cusvisittype},
							success:function(result){
								$('#showvisitexist').html(result);

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});

					});
					$("#visit_radio_submit").click(function(){
			        	var radioValue = $("input[name='VISIT_RADIO']:checked").val();
			        	var radioID = $("input[name='VISIT_RADIO']:checked").data('id');

			            if(radioValue){
			                $('#showselectedvisitradio').html(' <b>  '+radioValue+'</b>');
			                $('#visit_type_id').val(radioID);
			            }
			        });
			       //Accessories charges onchange
			        $("input[type='text'][name^='SERVICE_CHARGES']").keyup(function(){
		   				var serid=$(this).data('id');
		         		var title=$(this).data('title');
		         		$('#service_name_'+serid).val(title);
		         		$('#service_id_'+serid).val(serid);
					   	var chargessum=sumServiceUp();
					   	$('#total_services').val(chargessum);

					   	 Grantotalsum();

					});
					function sumServiceUp(){
					    var sum = 0;

					    $("input[type='text'][name^='SERVICE_CHARGES']").each(function(){

					         if (!isNaN(this.value) && this.value.length != 0) {
						      sum += parseFloat(this.value);
						    }
					    });
					   	return sum;
					}
					//Accessories charges onchange
					$("input[type='text'][name^='ACCESSORIES_CHARGES']").keyup(function(){
					   var accid=$(this).data('id');
		         		var title=$(this).data('title');
		         		$('#acc_name_'+accid).val(title);
		         		$('#acc_id_'+accid).val(accid);
					   	var chargessum=sumAccessUp();

					   	$('#total_accessories').val(chargessum);
					   	 Grantotalsum();

					});
					function sumAccessUp(){
					    var sum = 0;
					    $("input[type='text'][name^='ACCESSORIES_CHARGES']").each(function(){

					         if (!isNaN(this.value) && this.value.length != 0) {

						      sum += parseFloat(this.value);
						    }
					    });
					   	return sum;
					}
					//Discount onchange
					$("#discount_change").keyup(function(){
					   Grantotalsum();
					});

					function Grantotalsum(){

						var discount=$('#discount_change').val();
						var access=$('#total_accessories').val();
						var serv=$('#total_services').val();

						if(discount==""){
							discount=0;
						}
						if(access==""){
							access=0;
						}
						if(serv==""){
							serv=0;
						}
						var total=parseFloat(access)+parseFloat(serv);
						var grandtotal=parseFloat(total)-parseFloat(discount);
						$('#grand_total').val(grandtotal);
						$('#grand_total_val').val(grandtotal);
					}

					//Edit customer form
					$("#edit_cust_anchor").click(function(e) {
						$('#show_cust_table').css('display','none');
						$('#edit_cust_table').css('display','block');
						$('#jobcardtypepanel').css('display','none');
						var chassisno = $('#resp_chassis_no').text();
							$('#edit_chassis_no').val(chassisno);
						var engineno = $('#resp_engine_no').text();
							$('#edit_engine_no').val(engineno);
						var registno = $('#resp_regd_no').text();
							$('#edit_registration_no').val(registno);
						var colorno = $('#resp_cust_color_val').text();
							$('#edit_color_no').val(colorno);
						var modelno = $('#resp_cust_model_val').text();
							$('#edit_model_no').val(modelno);
						var custname = $('#resp_cust_name').text();
							$('#edit_cust_name').val(custname);
						var custaddress = $('#resp_cust_address').text();
							$('#edit_cust_address').val(custaddress);
						var custcontact = $('#resp_cust_contact').text();
							$('#edit_contact_no').val(custcontact);
						var custnic = $('#resp_cust_nic').text();
							$('#edit_nic_no').val(custnic);
						var custcity = $('#resp_cust_city_val').text();
							$('#edit_city').val(custcity);
						var cuspurchase = $('#resp_cust_purch_dt').text();
							$('#edit_cust_purch_dt').val(cuspurchase);
						var cusid = $('#resp_cust_id').text();
							$('#edit_cust_id').val(cusid);
						var vehid = $('#resp_cust_vehicle_id').text();
							$('#edit_vehicle_id').val(vehid);

					});
					//Edit customer form

					//Add New Job//
					$("#create_jc_anchor").click(function(e){
						$('#edit_cust_table').css('display','none');
						$('#add_job_table').css('display','block');
						$('#jobcardtypepanel').css('display','block');
						var custid=$('#resp_cust_id').text();
						$('#customer_id').val(custid);

					});
					//Add New Job//

					//Reset Job Form//
					$("#jobreset").click(function(e){
						$('#visit_type_id').val("");
						$('#showselectedvisitradio').html("");
						$(".js-example-basic-multiple").select2("val", "");
						$('#add-form').trigger("reset");
						$.smallBox({
									title : "Form Resetted",
									content : "<i class='fa fa-clock-o'></i> <i>Form successfully resetted</i>",
									color : "#659265",
									iconSmall : "fa fa-check fa-2x fadeInRight animated",
									timeout : 4000
								});

					});
					//Reset Job Form//

					//Certificate issued changed//
					$("select[name^='CERTIFICATE_ISSUE']").change(function(e){
						var val=$(this).val();
						var id=$(this).data('id');
						if(val==1){
							$('#showcertificatenumber-'+id).css('display','block');
						}
						else{
							$('#showcertificatenumber-'+id).css('display','none');
						}
					});
					//Certificate issued changed/


					//Filter Search form
					$("#filter-form").submit(function(e){
						e.preventDefault();
						var action= $('#filter-form').attr('action');
						var value =$("#filter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Ref#</td><td width="200">Customer  Name</td><td width="250">Open Date</td><td width="200">Visit Type</td><td width="100">Job Status</td><td width="100">Payment</td><td width="200">Actions</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Ref#</td><td width="200">Customer  Name</td><td width="250">Open Date</td><td width="200">Visit Type</td><td width="100">Job Status</td><td width="100">Payment</td><td width="200">Actions</td></tr><tr><td colspan="8">No Result Found</td></tr>');
									}
									else{
									$.each( result, function( key, value ) {
		  								// alert( key + ": " + value.KM_READING );

		  								$('.filterresult').append('<tr><td>'+(key+1)+'</td><td >'+value.REF_NUMBER+'</td><td>'+value.NAME+'</td><td >'+value.OPENING_DATE+'</td><td >'+value.SERVICE_NAME+'</td><td >'+value.JOB_STATUS+'</td><td >'+value.PAYMENT_STATUS+'</td><td>&nbsp;<a href="javascript:void(0);"  onclick="LoadAjaxScreen(`job_card/detail/'+value.ID+'`,`detail_job_card`)"  class="btn btn-success btn-circle"><i class="glyphicon glyphicon-eye-open" title="View Record"></i></a>&nbsp;'+(value.JOB_STATUS!="Closed" ? '<a href="javascript:void(0);"  onclick="LoadAjaxScreen(`job_card/edit/'+value.ID+'`,`edit_job_card`)"  class="btn btn-primary btn-circle"><i class="glyphicon glyphicon-pencil" title="Edit Record"></i></a>&nbsp;<a href="javascript:void(0);" onclick="closejobcard('+value.ID+')"  class="btn btn-danger btn-circle smallbox smart-mod-eg1" title="Close Job"><i class="glyphicon glyphicon-remove"></i></a>' : "")+'</td></tr>');
										});

									// <a href="javascript:void(0);" class="btn btn-success btn-circle" title="View Job Card"><i class="glyphicon glyphicon-eye-open"></i></a>



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// JOB CARD Filter Search form
					$("#jobcardfilter-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#jobcardfilter-form').attr('action');
						var value =$("#jobcardfilter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Ref#</td><td width="200">Customer  Name</td><td width="200">Open Date</td><td width="200">Visit Type</td><td width="200">Job Status</td><td width="100">Payment</td><td width="170">Actions</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Ref#</td><td width="200">Customer  Name</td><td width="200">Open Date</td><td width="200">Visit Type</td><td width="200">Job Status</td><td width="100">Payment</td><td width="170">Actions</td></tr><tr><td colspan="8">No Result Found</td></tr>');
									}
									else{
									$.each( result, function( key, value ) {
		  								// alert( key + ": " + value.KM_READING );

		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.REF_NUMBER+'</td><td>'+value.NAME+'</td><td >'+value.OPENING_DATE+'</td><td >'+value.SERVICE_NAME+'</td><td >'+value.JOB_STATUS+'</td><td >'+value.PAYMENT_STATUS+'</td><td>&nbsp;<a href="javascript:void(0);" onclick="LoadAjaxScreen(`job_card/detail/'+value.ID+'`,`detail_job_card`)" class="btn btn-success btn-sm" title="View Job Card"><i class="glyphicon glyphicon-eye-open"></i>  View </a></td></tr>');
										});
										//'+(value.JOB_STATUS!="Closed" ? '<a href="javascript:void(0);"  onclick="LoadAjaxScreen(`job_card/edit/'+value.ID+'`,`edit_job_card`)"  class="btn btn-primary btn-circle"><i class="glyphicon glyphicon-pencil" title="Edit Record"></i></a>&nbsp;<a href="javascript:void(0);" onclick="closejobcard('+value.ID+')"  class="btn btn-danger btn-circle smallbox smart-mod-eg1" title="Close Job"><i class="glyphicon glyphicon-remove"></i></a>' : "")+'
									// <a href="javascript:void(0);" class="btn btn-success btn-circle" title="View Job Card"><i class="glyphicon glyphicon-eye-open"></i></a>



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// Dealer Filter Search form
					$("#dealerfilter-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#dealerfilter-form').attr('action');
						var value =$("#dealerfilter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){

								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="150" >Code</td><td width="300">Dealer Name</td><td width="100">City</td><td width="200">Category</td><td width="100">Status</td><td width="200">Actions</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="150" >Code</td><td width="300">Dealer Name</td><td width="100">City</td><td width="200">Category</td><td width="100">Status</td><td width="200">Actions</td></tr><td colspan="8">No Result Found</td></tr>');
									}
									else{

									$.each( result, function( key, value ) {
		  								// alert( key + ": " + value.KM_READING );

		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.USER_NAME+'</td><td >'+value.NAME+'</td><td>'+value.CITY+'</td><td >'+value.CATEGORY_TYPE+'</td><td >'+(value.STATUS==1 ? 'Active': 'InActive')+'</td><td>&nbsp;<a href="javascript:void(0);" onclick="LoadAjaxScreen(`dealer/detail/'+value.ID+'`,`detail_dealer`)" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a href="javascript:void(0);" onclick="LoadAjaxScreen(`dealer/edit/'+value.ID+'`,`edit_dealer`)" class="btn btn-primary btn-circle"><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;<a href="javascript:void(0);" data-id="'+value.ID+'" data-cname="dealer" data-vname="view_dealer" data-action="'+baseurl+'admin/dealer/delete"  class="btn btn-danger btn-circle smallbox " onclick="deletedealer('+value.ID+')"	 ><i class="glyphicon glyphicon-remove"></i></a></td></tr>');
										});



									}



								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});

					// Dealer Filter Search form

					// Staff Filter Search form
					$("#stafffilter-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#stafffilter-form').attr('action');
						var value =$("#stafffilter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){

								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="300">Worker Name</td><td width="100">Designation</td><td width="200">Education</td><td width="100">Training Received</td><td width="100">Mobile</td><td width="100">Dealership</td><td width="200">Actions</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="300">Worker Name</td><td width="100">Designation</td><td width="200">Education</td><td width="100">Training Received</td><td width="100">Mobile</td><td width="100">Dealership</td><td width="200">Actions</td></tr>');
									}
									else{

									$.each( result, function( key, value ) {
		  								// alert( key + ": " + value.KM_READING );

		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.NAME+'</td><td >'+value.DESIGNATION+'</td><td>'+value.EDUCATION+'</td><td >'+value.TRAINING+'</td><td >'+value.CONTACT+'</td><td >'+value.DEALERSHIP+'</td><td>&nbsp;<a href="javascript:void(0);" onclick="LoadAjaxScreen(`staff/detail/'+value.ID+'`,`detail_staff`)" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a href="javascript:void(0);" onclick="LoadAjaxScreen(`staff/edit/'+value.ID+'`,`edit_staff`)" class="btn btn-primary btn-circle"><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;<a href="javascript:void(0);" class="btn btn-danger btn-circle smallbox " onclick="deletestaff('+value.ID+')" ><i class="glyphicon glyphicon-remove"></i></a></td></tr>');
										});



									}



								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});

					// Staff Filter Search form
					//Filter Search form
					// JOB CARD SUMMARY Filter Search form
					$("#jobcardsummaryfilter-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#jobcardsummaryfilter-form').attr('action');
						var value =$("#jobcardsummaryfilter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Dealer Code</td><td width="400">Dealer Name</td><td width="400">Job Cards</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Dealer Code</td><td width="400">Dealer Name</td><td width="400">Job Cards</td></tr><tr><td colspan="4">No Result Found</td>	</tr>');
									}
									else{
									$.each( result, function( key, value ) {
		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.ID+'</td><td>'+value.NAME+'</td><td >'+value.JOB_CARD+'</td></tr>');
										});



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// FREE SERVICE SUMMARY Filter Search form
					$("#freeservicesummaryfilter-form").submit(function(e){
						e.preventDefault();
						var action= $('#freeservicesummaryfilter-form').attr('action');
						var value =$("#freeservicesummaryfilter-form").serialize() ;
						$('#printbutton').css('display','block');
						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('#signingmartrix').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Code</td><td width="200">NTN</td><td width="400">Dealer Name</td><td width="300">CITY / TOWN</td><td width="300">TOTAL CARDS</td><td width="300">TOTAL AMOUNT</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Code</td><td width="200">NTN</td><td width="400">Dealer Name</td><td width="300">CITY / TOWN</td><td width="300">TOTAL CARDS</td><td width="300">TOTAL AMOUNT</td></tr><tr><td colspan="7">No Result Found</td></tr>');
									}
									else{
										// $('#printbutton').css('display','none');
									$.each( result, function( key, value ) {
										// console.log(value.ID);
										let TOTALAMOUNT = value.TOTALCARDS * 110 ;
		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.ID+'</td><td>'+value.O_NTN+'</td><td >'+value.NAME+'</td><td >'+value.TITLE+'</td><td >'+value.TOTALCARDS+'</td><td >'+TOTALAMOUNT+'</td></tr>');
										});



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// DEALER BUSINESS SUMMARY Filter Search form
					$("#dealerbusinesssummary-form").submit(function(e){
						e.preventDefault();
						var action= $('#dealerbusinesssummary-form').attr('action');
						var value =$("#dealerbusinesssummary-form").serialize() ;
						$('#printbutton').css('display','block');
						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('#signingmartrix').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Code</td><td width="200">NAME</td><td width="400">TOTAL SERVICE INCOMING</td><td width="200">TOTAL PARTS SALE</td><td width="200">TOTAL OIL SALE</td><td width="200">TOTAL LABOUR</td><td width="200">TOTAL REVENUE</td><td width="200">PARTS SALE / SI</td><td width="200">OIL SALE / SI</td><td width="200">LABOUR SALE / SI</td><td width="200">TOTAL COST / SI</td></tr><tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="200">Code</td><td width="200">NAME</td><td width="400">TOTAL SERVICE INCOMING</td><td width="200">TOTAL PARTS SALE</td><td width="200">TOTAL OIL SALE</td><td width="200">TOTAL LABOUR</td><td width="200">TOTAL REVENUE</td><td width="200">PARTS SALE / SI</td><td width="200">OIL SALE / SI</td><td width="200">LABOUR SALE / SI</td><td width="200">TOTAL COST / SI</td></tr><tr><td colspan="12">No Result Found</td></tr>');
									}
									else{
										// $('#printbutton').css('display','none');
									$.each( result, function( key, value ) {
										// console.log(value.ID);
										let PARTSSALESI =  value.TOTALPARTSSALE / value.SERVICES.TOTALSERVICES;
										let LABOURSALESI =  value.SERVICES.TOTALLABOUR / value.SERVICES.TOTALSERVICES;
										let TOTALREVENUE =  parseInt((value.ACCESSORIES.TOTALPARTS==null ? 0 :value.ACCESSORIES.TOTALPARTS)) + parseInt(value.SERVICES.TOTALLABOUR);
										let TOTALCOST =   parseInt(TOTALREVENUE) / parseInt(value.SERVICES.TOTALSERVICES);
										let OILSALESI=value.OILSALE.TOTALOIL/value.SERVICES.TOTALSERVICES;
										let sr=0;
		  								$('.filterresult').append(
											'<tr><td>'+(sr+1)+'</td><td >'+value.CODE+'</td><td>'+key+'</td><td >'+value.SERVICES.TOTALSERVICES+'</td><td >'+value.TOTALPARTSSALE+'</td><td >'+(value.OILSALE.TOTALOIL==null ? 0 : value.OILSALE.TOTALOIL)+'</td><td >'+value.SERVICES.TOTALLABOUR+'</td><td >'+TOTALREVENUE+'</td><td >'+PARTSSALESI+'</td><td >'+OILSALESI+'</td><td >'+LABOURSALESI+'</td><td >'+TOTALCOST+'</td></tr>');
										});



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//DEALER BUSINESS SUMMARY
					// FREE SERVICE DETAIL Filter Search form
					$("#freeservicedetailfilter-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#freeservicedetailfilter-form').attr('action');
						var value =$("#freeservicedetailfilter-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100">Sr.</td><td width="200">ENGINE NO</td><td width="200">CHASSIS NO</td><td width="400">MODEL NAME</td><td width="300">REG NO</td><td width="300">DATE</td><td width="300">REMARKS</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100">Sr.</td><td width="200">ENGINE NO</td><td width="200">CHASSIS NO</td><td width="400">MODEL NAME</td><td width="300">REG NO</td><td width="300">DATE</td><td width="300">REMARKS</td></tr><td colspan="7">No Result Found</td></tr>');
									}
									else{
									$.each( result, function( key, value ) {
										// console.log(value.ID);
		  								$('.filterresult').append(
											'<tr><td>'+(key+1)+'</td><td >'+value.ENGINE_NO+'</td><td>'+value.CHASSIS_NO+'</td><td >'+value.MODEL+'</td><td >'+value.REGISTRATION_NO+'</td><td >'+value.OPENING_DATE+'</td><td >'+value.SERVICE_NAME+'</td></tr>');
										});



									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// Busniess Summary I Filter Search form
					$("#businesssummary1-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#businesssummary1-form').attr('action');
						var value =$("#businesssummary1-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Month</td><td width="400" colspan=2 >Business</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="100">Month</td><td width="400">Business</td></tr><tr><td colspan="4">No Result Found</td></tr>');
									}
									else{
									$.each( result, function( key, value ) {	
		  								$('.filterresult').append(
											'<tr><td rowspan=5>'+(key+1)+'</td><td rowspan=5>'+value.MONTH_YEAR+'</td><td>Services Total</td><td>'+value.TOTAL_SERVICES+'</td></tr><tr><td>Parts Total</td><td>'+value.TOTAL_PARTS+'</td></tr><tr><td>Discount</td><td>'+value.TOTAL_DISCOUNT+'</td></tr><tr><td>Grand Total</td><td>'+value.GRAND_TOTAL+'</td></tr>');
										});


									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					// Busniess Summary II Filter Search form
					$("#businesssummary2-form").submit(function(e){
						e.preventDefault();
						$('#printbutton').css('display','block');
						var action= $('#businesssummary2-form').attr('action');
						var value =$("#businesssummary2-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
							dataType:'json',
							success:function(result){
								 if(result=='invalid'){
										$('#show_cust_table').css('display','none');
										$('#edit_cust_table').css('display','none');
										$('#jobcardtypepanel').css('display','none');
										$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid Number</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
										});
								}
								else{
									$('#filtersearchpanel').css('display','block');
									$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="400">Job Cards Status</td><td width="200">Payment Not Done</td><td width="200">Payment Done - Cash</td><td width="200">Payment Done - Credit</td></tr>');
									if(result==''){
										$('.filterresult').html('<tr><td width="100" >Sr.</td><td width="400">Job Cards Status</td><td width="200">Payment Not Done</td><td width="200">Payment Done - Cash</td><td width="200">Payment Done - Credit</td></tr><tr><td colspan="5">No Result Found</td></tr>');
									}
									else{
										var i=1;
									$.each( result, function( key, value ) {
		  								$('.filterresult').append(
											'<tr><td>'+i+'</td><td>'+key+'</td><td>'+value.Not_done.CCOUNT+'</td><td>'+value.Done_cash.CCOUNT+'</td><td>'+value.Credit.CCOUNT+'</td></tr>');
		  								i++;
										});

									
									}

								}

							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Filter Search form
					//Edit Submit
					$("#edit-form").submit(function(e){
						e.preventDefault();
						var action= $('#edit-form').attr('action');
						var value =$("#edit-form").serialize() ;
						$.ajax({
							url:action,
							type:'POST',
							data:value,
							success:function(result){
									if(result=='failed'){
									$.smallBox({
													title : "Record Already Exists",
													content : "<i class='fa fa-clock-o'></i> <i>Please enter another title</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});
								}
								else if(result=='updated'){
											$.smallBox({
													title : "Record Updated",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully updated</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
									$('#add-form').trigger("reset");
								}
								else{
										$.smallBox({
													title : "Validation Error",
													content : " <i>"+result+"</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});

								}
							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Edit Submit



					//seachby
					$(".searchby").click(function () {
				        var value = this.value;

					        if(value=='chassisno'){
					        	$('#chassisnopanel').css("display", "block");
					        	$('#registrationnopanel').css("display", "none");
					        	$('input[name="REGISTRATIONNO"]').val("");
					        	  $('#searchbypanel').show();

					        }else if(value='registrationno'){
					        	$('#registrationnopanel').css("display", "block");
					        	$('#chassisnopanel').css("display", "none");
					        	$('input[name="CHASSISNO"]').val("");
					        	$('#searchbypanel').show();
					        }
					});
					//searchby
						//Add Submit
					$("#add-form").submit(function(e){
						e.preventDefault();
						var action= $('#add-form').attr('action');
						var value =$("#add-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
        					processData: false,
							success:function(result){
								if(result=='failed'){
									$.smallBox({
													title : "Record Already Exists",
													content : "<i class='fa fa-clock-o'></i> <i>Please enter another title</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});
								}
								else if(result=='added'){
											$.smallBox({
													title : "Record Added",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully added</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
									$('#add-form').trigger("reset");
								}
								else if(result=='cardadded'){
											$.smallBox({
													title : "Record Added",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully added</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
											$('#visit_type_id').val("");
											$('#showselectedvisitradio').html("");
											$(".js-example-basic-multiple").select2("val", "");
											$('#add-form').trigger("reset");
								}
								else{
										$.smallBox({
													title : "Validation Error",
													content : " <i>"+result+"</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});

								}
							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});

					//Add Submit

					//Add customer Submit through jobcard
					$("#add-cust-form").submit(function(e){
						e.preventDefault();
						var action= $('#add-cust-form').attr('action');
						var value =$("#add-cust-form").serialize() ;

						data = new FormData();

						$.ajax({
							url:action,
							type:'POST',
							data: value,
        					processData: false,
							success:function(result){
								if(result=='failed'){
									$.smallBox({
													title : "Record Already Exists",
													content : "<i class='fa fa-clock-o'></i> <i>Please enter another title</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});
								}
								else if(result=='added'){
											$.smallBox({
													title : "Record Added",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully added</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
									$('#add-cust-form').trigger("reset");
								}
								else if(result=='cardadded'){
											$.smallBox({
													title : "Record Added",
													content : "<i class='fa fa-clock-o'></i> <i>Record successfully added</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
											$('#visit_type_id').val("");
											$('#showselectedvisitradio').html("");
											$(".js-example-basic-multiple").select2("val", "");
											$('#add-cust-form').trigger("reset");
								}
								else{
										$.smallBox({
													title : "Validation Error",
													content : " <i>"+result+"</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});

								}
							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});

					//Add Submit

					  $("input[type='checkbox'][name^='TRAINING']").click(function(){
					  		var tid=$(this).data('id');
					  		if($(this).is(':checked')){
					  			// $(this).prop("checked", false);

					  			$('#trainingdetailspanel-'+tid).css('display','block');
					  		}
					  		else{

					  			var strt=$('#startdate-'+tid).val('');
					  			var strt=$('#enddate-'+tid).val('');
					  			var strt=$('#certificate-'+tid).val('');
					  			$('#trainingdetailspanel-'+tid).css('display','none');
					  		}

					});


					  $("#addtrackrow").click(function(){

					  		$('#rowtrackpanel').append('<div class="row"><section class="col col-6"><label class="input"> Workshop/Dealership<input type="text" name="WORKSHOP[]" placeholder="Enter Workshop/Dealership"></label></section></div><div class="row"><section class="col col-2"><label class="input">Start Date<input type="date" name="FROM_DATE[]" autocomplete="off" placeholder="Select Start Date" class="datepicker"></label></section><section class="col col-2"><label class="input">End Date<input type="date" name="TO_DATE[]" placeholder="Select End Date" class="datepicker" autocomplete="off"></label></section><section class="col col-2"><label class="input">Salary<input type="text" name="SALARY[]" placeholder="Enter Salary"></label></section><section class="col col-2"><label class="input">Commission<input type="text" name="COMMISSION[]" placeholder="Enter Commission"></label></section><section class="col col-2"><div class="inline-group"><label class="checkbox"><input type="checkbox" name="CONTRACT[]" value="1" ><i></i>Contract</label></div></section></div>');

					});
					   // $(".delete-row").click(function(){
			     //        $("table tbody").find('input[name="record"]').each(function(){
			     //            if($(this).is(":checked")){
			     //                $(this).parents("tr").remove();
			     //            }
			     //        });
			     //    });




	   	}
	   	else{
	   		$('#showloadscreen').html('<h3>No Page Found</h3>')
	   	}
	  },


   });

}
function closejobcard(id){

	$.ajax({
			url:baseurl+'admin/job_card/closedetails',
			type:'POST',
			data:{id:id},   //JOB ID
			success:function(result){
				if(result=='failed'){

						$.smallBox({
									title : "Validation Error",
									content : " <i>Invalid UserName/Password.</i>",
									color : "#C46A69",
									iconSmall : "fa fa-times fa-2x fadeInRight animated",
									timeout : 4000
								});
					setTimeout(function(){$("#msg").hide(); }, 3000);
				}
				else{
					var data=$.parseJSON(result);
					$('#job_id').val(data.ID);
					$('#discount').val(data.DISCOUNT);
					$('#total_services').val(data.TOTAL_SERVICES);
					$('#total_accessories').val(data.TOTAL_ACCESSORIES);
					$('#payment_status').val(data.PAYMENT_STATUS);
					$('#total').val(data.TOTAL);
					$('#closejobmodal').modal('show');

					//Edit Submit
					$("#close-form").submit(function(e){
						e.preventDefault();
						var action= $('#close-form').attr('action');
						var value =$("#close-form").serialize() ;
						$.ajax({
							url:action,
							type:'POST',
							data:value,
							success:function(result){
									if(result=='updated'){
											$.smallBox({
													title : "Job Card Closed",
													content : "<i class='fa fa-clock-o'></i> <i>Jobcard successfully closed</i>",
													color : "#659265",
													iconSmall : "fa fa-check fa-2x fadeInRight animated",
													timeout : 4000
												});
										$("#closejobmodal .close").click();
									$('#filter-form').trigger("submit");
								}
								else{
										$.smallBox({
													title : "Validation Error",
													content : " <i>"+result+"</i>",
													color : "#C46A69",
													iconSmall : "fa fa-times fa-2x fadeInRight animated",
													timeout : 4000
												});

								}
							},
							error: function (xhr, textStatus, errorThrown){
								alert(xhr.responseText);
							}
						});
					});
					//Edit Submit



				}
			},
			error: function (xhr, textStatus, errorThrown){
				alert(xhr.responseText);
			}
		});


}

function  editjobback(){
	 LoadAjaxScreen('job_card','view_job_card');
	 $('#filter-form').trigger('submit');
}

$("#login-form").submit(function(e){
			e.preventDefault();
			var value =$("#login-form").serialize() ;
			$.ajax({
				url:baseurl+'admin/login_submit',
				type:'POST',
				data:value,
				success:function(result){
					if(result=='failed'){

							$.smallBox({
										title : "Validation Error",
										content : " <i>Invalid UserName/Password.</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
									});
						setTimeout(function(){$("#msg").hide(); }, 3000);
					}
					else if(result=='success'){
						window.location.href="admin";
					}
					else{
						$.smallBox({
										title : "Validation Error",
										content : " <i>"+result+"</i>",
										color : "#C46A69",
										iconSmall : "fa fa-times fa-2x fadeInRight animated",
										timeout : 4000
									});
						
					}
				},
				error: function (xhr, textStatus, errorThrown){
					alert(xhr.responseText);
				}
			});
});


function printDiv()
{
	$('.logoprint').css('display','block');
	$('#printbutton').css('display','none');
var divToPrint=document.getElementById('showprint');

var newWin=window.open('','Print-Window');

newWin.document.open();

newWin.document.write('<html><body onload="window.print()">'+divToPrint.innerHTML+'</body></html>');

newWin.document.close();
$('.logoprint').css('display','none');
$('#printbutton').css('display','block');
setTimeout(function(){newWin.close();
},10);

}
